
variable sigma equal 3.405
variable epsilon equal 0.238
variable U0 equal 2*${epsilon}
variable dlt equal 0.5
variable x0 equal 5.0

units real
atom_style atomic
pair_style lj/cut 3.822
pair_modify shift yes
boundary p p p

region myreg block −25 25 −5 5 −25 25
create_box 1 myreg
create_atoms 1 random 200 34134 myreg overlap 1.5 maxtry 50

mass * 39.95
pair_coeff * * ${epsilon} ${sigma}
neigh_modify every 1 delay 4 check yes

minimize 1e−4 1e−6 100 1000
reset_timestep 0

variable U atom ${U0}*atan((x+${x0})/${dlt})-${U0}*atan((x−${x0})/${dlt})
variable F atom ${U0}/((x−${x0})^2/${dlt}^2+1)/${dlt}-${U0}/((x+${x0})^2/${dlt}^2+1)/${dlt}
fix myadf all addforce v_F 0.0 0.0 energy v_U

fix mynve all nve
fix mylgv all langevin 119.8 119.8 50 1530917

region mymes block −${x0} ${x0} INF INF INF INF
variable n_center equal count(all,mymes)
thermo_style custom step temp etotal v_n_center
thermo 10000

dump viz all image 50000 myimage−*.ppm type type &
    shiny 0.1 box yes 0.01 view 180 90 zoom 7 size 1600 400
dump_modify viz backcolor white acolor 1 cyan adiam 1 1 boxcolor black

timestep 2.0
run 500000
reset_timestep 0

compute cc1 all chunk/atom bin/1d x 0.0 1.0
fix myac all ave/chunk 10 400000 4000000 cc1 density/number file density_proﬁle.dat

run 4000000
