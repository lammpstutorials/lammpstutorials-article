LAMMPS (29 Aug 2024 - Development - patch_29Aug2024-566-g224468d946-modified)
# inserting styrene molecules around a periodic CNT

units real

boundary p p p

atom_style full

kspace_style pppm 1.0e-5

pair_style lj/class2/coul/long 8.5

angle_style class2

bond_style class2

dihedral_style class2

improper_style class2

special_bonds lj/coul 0 0 1
pair_modify tail yes mix sixthpower

variable T equal 530

read_data CNT.data   extra/special/per/atom 20
Reading data file ...
  orthogonal box = (-43.564937 -40 -40) to (43.564937 40 40)
  4 by 2 by 4 MPI processor grid
  reading atom labelmap ...
  reading bond labelmap ...
  reading angle labelmap ...
  reading dihedral labelmap ...
  reading improper labelmap ...
  reading atoms ...
  1056 atoms
  reading velocities ...
  1056 velocities
  scanning bonds ...
  3 = max bonds/atom
  scanning angles ...
  3 = max angles/atom
  scanning dihedrals ...
  12 = max dihedrals/atom
  scanning impropers ...
  1 = max impropers/atom
  orthogonal box = (-43.564937 -40 -40) to (43.564937 40 40)
  4 by 2 by 4 MPI processor grid
  reading bonds ...
  1584 bonds
  reading angles ...
  3168 angles
  reading dihedrals ...
  6336 dihedrals
  reading impropers ...
  1056 impropers
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        1       
  special bond factors coul:  0        0        1       
     3 = max # of 1-2 neighbors
     6 = max # of 1-3 neighbors
    29 = max # of special neighbors
  special bonds CPU = 0.002 seconds
  read_data CPU = 0.059 seconds

#write_data CNT.data

molecule styrene styrene.molecule_template
Read molecule template styrene:
styrene_molecule
  1 molecules
  0 fragments
  16 atoms with max type 4
  16 bonds with max type 11
  24 angles with max type 19
  32 dihedrals with max type 21
  8 impropers with max type 9

create_atoms 0 random 1000 8305 NULL overlap 2.75   maxtry 500 mol styrene 7687
WARNING: Only inserted 999 particles out of 1000 (../create_atoms.cpp:893)
Created 15984 atoms
  using lattice units in orthogonal box = (-43.564937 -40 -40) to (43.564937 40 40)
  create_atoms CPU = 1.320 seconds

thermo_style custom step density temp etotal press pxx pyy pzz lx ly lz

minimize 1.0e-4 1.0e-6 100 1000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- Type Label Framework: https://doi.org/10.1021/acs.jpcb.3c08419

@Article{Gissinger24,
 author = {Jacob R. Gissinger, Ilia Nikiforov, Yaser Afshar, Brendon Waters, Moon-ki Choi, Daniel S. Karls, Alexander Stukowski, Wonpil Im, Hendrik Heinz, Axel Kohlmeyer, and Ellad B. Tadmor},
 title = {Type Label Framework for Bonded Force Fields in LAMMPS},
 journal = {J. Phys. Chem. B},
 year =    2024,
 volume =  128,
 number =  13,
 pages =   {3282--3297}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

PPPM initialization ...
WARNING: System is not charge neutral, net charge = 211.0002 (../kspace.cpp:327)
  using 12-bit tables for long-range coulomb (../kspace.cpp:342)
  G vector (1/distance) = 0.27506117
  grid = 36 36 36
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0034350933
  estimated relative force accuracy = 1.0344682e-05
  using double precision KISS FFT
  3d grid and FFT values/proc = 4508 2592
Generated 21 of 21 mixed pair_coeff terms from sixthpower/sixthpower mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 10.5
  ghost atom cutoff = 10.5
  binsize = 5.25, bins = 17 16 16
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/class2/coul/long, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d
      bin: standard
WARNING: Inconsistent image flags (../domain.cpp:1051)
Per MPI rank memory allocation (min/avg/max) = 15.06 | 15.08 | 15.17 Mbytes
   Step        Density          Temp          TotEng         Press           Pxx            Pyy            Pzz             Lx             Ly             Lz      
         0   0.34761281     17.644269      371476.17      4142.167       6150.893       6829.2787     -553.67091      87.129874      80             80           
       100   0.34761281     17.644269      255469.33     -7589.6411     -1091.0191     -10825.649     -10852.255      87.129874      80             80           
Loop time of 0.541063 on 32 procs for 100 steps with 17040 atoms

97.0% CPU use with 32 MPI tasks x no OpenMP threads

Minimization stats:
  Stopping criterion = max iterations
  Energy initial, next-to-last, final = 
      370580.014860093   254601.075890351   254573.174228796
  Force two-norm initial, final = 29259.13 197.17728
  Force max component initial, final = 660.08646 15.936135
  Final line search alpha, max atom move = 0.0019101557 0.030440499
  Iterations, force evaluations = 100 187

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.11933    | 0.14487    | 0.17858    |   3.5 | 26.77
Bond    | 0.11844    | 0.14206    | 0.1739     |   4.2 | 26.26
Kspace  | 0.13953    | 0.20545    | 0.25206    |   6.1 | 37.97
Neigh   | 0.012835   | 0.012881   | 0.012936   |   0.0 |  2.38
Comm    | 0.025827   | 0.027098   | 0.02801    |   0.3 |  5.01
Output  | 0.00012221 | 0.00012926 | 0.00014089 |   0.0 |  0.02
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.008579   |            |       |  1.59

Nlocal:          532.5 ave         602 max         492 min
Histogram: 5 5 4 6 3 4 2 2 0 1
Nghost:        2763.97 ave        2958 max        2544 min
Histogram: 2 2 4 4 0 6 3 6 3 2
Neighs:        40020.2 ave       48477 max       32721 min
Histogram: 1 3 5 4 7 3 3 3 1 2

Total # of neighbors = 1280648
Ave neighs/atom = 75.155399
Ave special neighs/atom = 8.6482394
Neighbor list builds = 7
Dangerous builds = 0

velocity all create 300.0 4928459 rot yes dist gaussian loop local

thermo_style custom step density temp etotal press pxx pyy pzz lx ly lz

fix 1 all nvt temp 300 300 100 #y 1 1 3000 z 1 1 3000

fix 2 all deform 1 y erate -0.0001 z erate -0.0001

variable density equal density

fix 3 all halt 10 v_density > 0.9 error continue

thermo 500

dump myDump all xyz 100 test.xyz

run 9000
PPPM initialization ...
  using 12-bit tables for long-range coulomb (../kspace.cpp:342)
  G vector (1/distance) = 0.27506117
  grid = 36 36 36
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0034350933
  estimated relative force accuracy = 1.0344682e-05
  using double precision KISS FFT
  3d grid and FFT values/proc = 4508 2592
Generated 21 of 21 mixed pair_coeff terms from sixthpower/sixthpower mixing rule
WARNING: Inconsistent image flags (../domain.cpp:1051)
Per MPI rank memory allocation (min/avg/max) = 13.95 | 13.97 | 14.06 Mbytes
   Step        Density          Temp          TotEng         Press           Pxx            Pyy            Pzz             Lx             Ly             Lz      
       100   0.34761281     300            269810.18     -6414.0378      83.373986     -9638.5794     -9686.9081      87.129874      80             80           
       500   0.37718404     254.88444      268137.3      -8162.2858     -1776.5865     -11287.011     -11423.26       87.129874      76.8           76.8         
      1000   0.41977154     314.28458      260818.95     -9444.8629     -3714.1682     -12166.147     -12454.273      87.129874      72.8           72.8         
      1500   0.4700011      304.24881      249924.04     -10324.449     -5188.9787     -12829.622     -12954.747      87.129874      68.8           68.8         
      2000   0.52981681     302.00448      238419.45     -12029.534     -7003.9724     -14794.4       -14290.231      87.129874      64.8           64.8         
      2500   0.60182273     302.01293      227177.01     -14190.394     -10644.054     -15752.386     -16174.742      87.129874      60.8           60.8         
      3000   0.68957114     300.00594      215282.94     -16502.603     -13771.089     -18400.99      -17335.73       87.129874      56.8           56.8         
      3500   0.79800921     297.25631      202753.65     -18780.174     -18095.609     -18655.569     -19589.343      87.129874      52.8           52.8         
Fix halt condition for fix-id 3 met on step 3890 with value 0.9013896603771433 (../fix_halt.cpp:240)
Loop time of 14.4437 on 32 procs for 3790 steps with 17040 atoms

Performance: 22.671 ns/day, 1.059 hours/ns, 262.399 timesteps/s, 4.471 Matom-step/s
98.1% CPU use with 32 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.4969     | 3.5937     | 4.9245     |  37.9 | 24.88
Bond    | 1.9804     | 2.6972     | 3.3912     |  26.3 | 18.67
Kspace  | 3.191      | 5.1013     | 6.8327     |  50.1 | 35.32
Neigh   | 0.82013    | 0.82391    | 0.82848    |   0.2 |  5.70
Comm    | 0.7503     | 0.77559    | 0.84476    |   2.5 |  5.37
Output  | 0.031092   | 0.051743   | 0.069465   |   4.9 |  0.36
Modify  | 0.67967    | 0.80461    | 1.2989     |  20.5 |  5.57
Other   |            | 0.5957     |            |       |  4.12

Nlocal:          532.5 ave         604 max         466 min
Histogram: 1 2 4 8 1 3 5 7 0 1
Nghost:        4664.62 ave        4780 max        4543 min
Histogram: 5 1 2 5 4 0 4 5 2 4
Neighs:         102963 ave      121341 max       82558 min
Histogram: 1 2 4 6 3 2 3 5 4 2

Total # of neighbors = 3294830
Ave neighs/atom = 193.35857
Ave special neighs/atom = 8.6482394
Neighbor list builds = 258
Dangerous builds = 0

unfix 2
unfix 3

run 10000
PPPM initialization ...
  using 12-bit tables for long-range coulomb (../kspace.cpp:342)
  G vector (1/distance) = 0.28757057
  grid = 40 25 25
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0033264521
  estimated relative force accuracy = 1.0017512e-05
  using double precision KISS FFT
  3d grid and FFT values/proc = 3705 1120
Generated 21 of 21 mixed pair_coeff terms from sixthpower/sixthpower mixing rule
WARNING: Inconsistent image flags (../domain.cpp:1051)
Per MPI rank memory allocation (min/avg/max) = 15.03 | 15.28 | 15.45 Mbytes
   Step        Density          Temp          TotEng         Press           Pxx            Pyy            Pzz             Lx             Ly             Lz      
      3890   0.90138966     298.86743      193196.88     -20669.223     -21815.115     -20048.038     -20144.514      87.129874      49.68          49.68        
      4000   0.90138966     298.35686      192919.69     -21294.809     -22512.317     -21433.658     -19938.451      87.129874      49.68          49.68        
      4500   0.90138966     299.17881      193385.19     -22148.311     -23368.969     -21492.255     -21583.71       87.129874      49.68          49.68        
      5000   0.90138966     305.64921      193747.89     -21660.18      -22803.68      -21890.785     -20286.074      87.129874      49.68          49.68        
      5500   0.90138966     300.11618      193320.85     -22704.487     -23700.572     -21625.09      -22787.797      87.129874      49.68          49.68        
      6000   0.90138966     299.03893      193676.83     -22661.805     -24031.414     -22233.014     -21720.986      87.129874      49.68          49.68        
      6500   0.90138966     299.30614      193230.36     -23293.156     -24213.942     -22028.619     -23636.906      87.129874      49.68          49.68        
      7000   0.90138966     300.34264      193396.5      -23185.053     -23842.691     -22906.747     -22805.72       87.129874      49.68          49.68        
      7500   0.90138966     301.12174      193417.87     -22741.042     -23326.468     -22812.022     -22084.636      87.129874      49.68          49.68        
      8000   0.90138966     299.03696      193392.17     -23878.853     -25399.951     -22812.512     -23424.096      87.129874      49.68          49.68        
      8500   0.90138966     301.33078      193595.23     -23561.472     -24606.653     -23068.198     -23009.564      87.129874      49.68          49.68        
      9000   0.90138966     300.3531       193576.8      -23753.7       -24070.154     -23487.747     -23703.201      87.129874      49.68          49.68        
      9500   0.90138966     299.40771      193407.39     -22616.306     -23205.753     -22075.285     -22567.879      87.129874      49.68          49.68        
     10000   0.90138966     300.95215      193402.63     -23254.076     -24612.302     -22350.311     -22799.616      87.129874      49.68          49.68        
     10500   0.90138966     299.8429       193262.01     -23038.102     -23647.943     -22384.148     -23082.214      87.129874      49.68          49.68        
     11000   0.90138966     300.65582      193453.24     -22850.106     -24288.251     -21977.677     -22284.388      87.129874      49.68          49.68        
     11500   0.90138966     303.14713      193497.65     -23589.186     -25072.38      -22690.615     -23004.562      87.129874      49.68          49.68        
     12000   0.90138966     295.06122      192956.77     -24822.216     -26014.559     -24240.401     -24211.687      87.129874      49.68          49.68        
     12500   0.90138966     299.02027      193373.85     -23357.017     -24383.816     -23314.19      -22373.045      87.129874      49.68          49.68        
     13000   0.90138966     299.17257      193336.43     -24012.72      -25194.899     -23448.731     -23394.53       87.129874      49.68          49.68        
     13500   0.90138966     300.01369      193350.63     -24041.934     -24780.2       -23260.854     -24084.75       87.129874      49.68          49.68        
     13890   0.90138966     298.73517      193191.99     -24165.823     -24911.557     -23636.331     -23949.581      87.129874      49.68          49.68        
Loop time of 36.3297 on 32 procs for 10000 steps with 17040 atoms

Performance: 23.782 ns/day, 1.009 hours/ns, 275.257 timesteps/s, 4.690 Matom-step/s
96.8% CPU use with 32 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 12.493     | 14.693     | 16.96      |  44.8 | 40.44
Bond    | 5.9522     | 7.1338     | 8.4755     |  38.4 | 19.64
Kspace  | 5.5716     | 9.0334     | 12.369     |  90.3 | 24.86
Neigh   | 2.001      | 2.0091     | 2.0178     |   0.3 |  5.53
Comm    | 2.6499     | 2.6903     | 2.7524     |   1.4 |  7.41
Output  | 0.080838   | 0.13288    | 0.18287    |   8.3 |  0.37
Modify  | 0.13989    | 0.16571    | 0.20131    |   5.5 |  0.46
Other   |            | 0.4715     |            |       |  1.30

Nlocal:          532.5 ave         594 max         459 min
Histogram: 1 5 7 2 1 0 2 0 9 5
Nghost:        4663.84 ave        4840 max        4504 min
Histogram: 2 8 6 0 0 2 0 9 3 2
Neighs:         103380 ave      121708 max       83146 min
Histogram: 4 7 4 1 0 0 0 2 6 8

Total # of neighbors = 3308147
Ave neighs/atom = 194.14008
Ave special neighs/atom = 8.6482394
Neighbor list builds = 526
Dangerous builds = 0

#unfix 1

#fix 1 all npt temp 300 300 100 y 1 1 3000 z 1 1 3000

#run 10000

write_data composite.data
System init for write_data ...
PPPM initialization ...
  using 12-bit tables for long-range coulomb (../kspace.cpp:342)
  G vector (1/distance) = 0.28757057
  grid = 40 25 25
  stencil order = 5
  estimated absolute RMS force accuracy = 0.0033264521
  estimated relative force accuracy = 1.0017512e-05
  using double precision KISS FFT
  3d grid and FFT values/proc = 3705 1120
Generated 21 of 21 mixed pair_coeff terms from sixthpower/sixthpower mixing rule

Total wall time: 0:00:53
